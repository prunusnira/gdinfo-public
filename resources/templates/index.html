<!-- /*****************************************************
 * GITADORA Info Server
 * Developed by Tae Jun Kang a.k.a Prunus Nira
 * (c) Nira 2016
 *
 * 1. This project is protected under GNU AGPL v3.0
 *    Please refer to LICENSE file on root
 * 2. Also, products and libraries used to implement
 *    this server are on USED-LIBRARIES file on root
 *****************************************************/ -->
 <!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<meta name="description" content="GITADORA Info">
<meta name="author" content="">
<meta name="google-signin-client_id"
	content="clientid.apps.googleusercontent.com">
<link rel="icon" href="/favicon.ico">
<script src="/function/language.js"></script>
<script src="/function/language/index.js"></script>
<title>GITADORA Info</title>

<!-- Bootstrap core CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<!-- Custom css -->
<link href="/css/custom/header.css" rel="stylesheet">
<link href="/css/custom/footer.css" rel="stylesheet">
<link href="/css/custom/skillcolor.css" rel="stylesheet">
<link href="/css/custom/skillcolor-rainbow.css" rel="stylesheet">

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
	
	<!-- Google Adsense -->
	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({
			google_ad_client: "ca-pub-adsenseid",
			enable_page_level_ads: true
		});
	</script>
</head>

<body>
	<section class="container">
		<div class="row">
			<div class="col-12">
				<div id="self" class='card' style='font-size:90%;'>
					<div class='card-header'>
						<h3><script>document.write(txtIndex.self.title[lang]);</script></h3>
					</div>
					<div class='card-body text-center' id="selfBody" v-html="selfInfo">
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-12">
				<div class="card" style="font-size:90%;">
					<div class="card-header">
						<h3><script>document.write(txtIndex.recent[lang]);</script></h3>
					</div>
					<div class="card-body">
						<div class="card-text">
							<div class="row">
								<div class="col-12 text-center" style="padding-bottom:20px;">
									<script>document.write(txtIndex.click[lang]);</script>
								</div>
								<div class="col-12" id="rec">
									<recent-div v-for="rec in reclist" v-bind:rec="rec"></recent-div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-12">
				<div class="card" style="font-size:90%;">
					<div class="card-header">
						<h3><script>document.write(txtIndex.notice[lang]);</script></h3>
					</div>
					<div class="card-body">
						<a class="twitter-timeline" data-dnt="true"
							href="https://twitter.com/gitadorainfo"
							data-widget-id="731000889108914176">GITADORA Info Twitter</a>
						<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- /container -->

	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="/js/jquery-3.3.1.min.js"></script>
	<script src="/js/vue.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/function/skillcolor.js"></script>
	<script src="/function/towertitle.js"></script>
	<script src="/function/overall.js"></script>
	<script src="https://apis.google.com/js/platform.js?onload=gsignLoad" async defer></script>
	<div style='display: none'>
		<form action='/logout' id='logout' method='post'></form>
	</div>

	<template id="recent-template">
		<div class="table-border-bottom" style="padding:5px;">
			<div class="row">
				<div class="col-7">
					<div class="row">
						<div class="col-12 text-left">
							<span id="towertitle" v-html="rec.towertitle"></span>
							<a class="innerhref title" v-bind:href="rec.link">{{ rec.username }}</a>
						</div>
					</div>
					<div class="row">
						<div class="col-12">
							{{ rec.updateTime }}
						</div>
					</div>
				</div>
				<div class="col-5">
					<div class="row">
						<div class="col-3 text-right">G</div>
						<div class="col-9 text-left blackandwhite">
							<a class="skill" v-bind:href="rec.glink">{{ rec.gskill }}</a>
						</div>
					</div>
					<div class="row">
						<div class="col-3 text-right">D</div>
						<div class="col-9 text-left blackandwhite">
							<a class="skill" v-bind:href="rec.dlink">{{ rec.dskill }}</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</template>

	<script th:inline="javascript">
	Vue.component('recent-div', {
		template: '#recent-template',
		props: {
			rec: Object
		}
	});

	var vmRecent = new Vue({
		el: '#rec',
		data: {
			reclist: []
		},
		created: function() {
			var self = this;

			$.ajax("/d/recent")
			.done(function(data) {
				var json = JSON.parse(data);
				var array = json.recent;

				for(var i = 0; i < array.length; i++) {
					var current = array[i];
					var towertitleImg = "";
					if(current.titletower != "") {
						towertitleImg = '<img class="towertitle35" src="/img/title/'+current.titletower+'.png" />';
					}

					var date = new Date().getTime() - current.uptimelong;
					var hour = date/60000/60;
					var min = date/60000%60;

					var obj = {
						towertitle: towertitleImg,
						username: current.name+" â“Ÿ",
						updateTime: Math.floor(hour)+text.other.hrs[lang]+" "+Math.floor(min)+text.other.mins[lang],
						gskill: current.gskill.toFixed(2),
						glink: "/skill/2/"+current.id+"/gf/1/1",
						dskill: current.dskill.toFixed(2),
						dlink: "/skill/2/"+current.id+"/dm/1/1",
						link: '/profile/'+current.id
					};

					self.reclist.push(obj);
				}
			});
		},
		updated: function() {
			updateColor();
		}
	});

	var token = /*[[${token}]]*/'';

    var vmSelf = new Vue({
        el:'#selfBody',
        data: {
			selfInfo: ''
        },
        created: function() {
            var self = this;
            if(token != null) {
                $.ajax("/d/getuser/"+token)
                .done(function(data) {
					var json = JSON.parse(data);
					
					self.selfInfo =
						"<div class='card-text'>"+
							"<span id='selftitle'>"+
								"("+json.mydata.title+")"+
							"</span><br/>"+
							"<span id='towertitleself'>";
					if(json.mydata.titletower != "") {
                        self.selfInfo += "<img class='towertitle35' src='/img/title/"+json.mydata.titletower+".png' />";
                    }
			self.selfInfo += "</span>"+
							"<span style='font-size:125%' id='selfname'>"+
								json.mydata.name+
							"</span><br/>"+
							"<span><b>GF</b>"+
								json.mydata.gskill+
							"</span>&nbsp;&nbsp;&nbsp;"+
							"<span><b>DM</b>"+
								json.mydata.dskill+
							"</span>"+
						"</div>";
				});
			}
			else {
				self.selfInfo = txtIndex.self.loginFirst[lang];
			}
        }
    });
	</script>
	<div th:insert="header :: header"></div>
	<div th:insert="footer :: footer"></div>
	<script src="/function/menu.js"></script>
</body>
</html>
